## [Crypto] First try to the RSA

### 問題文

オイラー「はじめまして。」

### 配布ファイル

- `First_try_to_the_RSA.py`

```python=
from Crypto.Util.number import *
from flag import *

m = bytes_to_long(flag)

p = getStrongPrime(512)
q = getStrongPrime(512)
N = p * q
e = 65537

print("N =", N)
print("p =", p)
print("q =", q)
print("e =", e)
print("c =", pow(m, e, N))
```

- `First_try_to_the_RSA.txt`

```
N = 139545190714430068475576764812975357667464073284160289806505868139812654946288354726950792923375840936420303267807422056935679442929570433104035467123877055792288916411159874481480708680994573100772667181210728673208401103290224577385585201704579349144430206926796515330551855562249705212503592520460211886543
p = 11383938152199742827534935881358756240953537245001429975067950092568380785232734527454719451207567674269717863796856119055836926302422957310664236155138179
q = 12258077024730273280785134915444958829950078762102753700909392695406980129736481201561609328208930770948117006493475096389813750697110857899618785618712517
e = 65537
c = 89675246336626125589202524856849238298873897483128546629098448254648587539910961108277785357974755856265417656437743402598137226531575794232735408657938035104005955311135456462714396628353894890013983440582041571931121456643482287667095371606889333823039961323430089926834087279121016547453409637455052852523
```

### 必要な知識と簡単な解説

- RSA暗号の復号の仕方

RSA暗号について、どこから書くべきなのかは非常に難しいですが、RSAの基本として以下の知識があればこの問題を解くことができます。  

```
素数の組p, q、適当な正整数eが決定した場合、

n = p × q
d = e^(-1) mod {(p-1)×(q-1)}

{n, e}の組が公開鍵、{n, d}の組が秘密鍵となる。

平文をm、暗号文をcとすると以下の関係になる。

c = m^e mod n
m = c^d mod n
```

### 方針

N, p, q, e, cが与えられているので、やることはmを求めるためにdを計算するだけです。  

### writeup

入門的なRSAの問題です。  

```
d = e^(-1) mod {(p-1)×(q-1)}
m = c^d mod N
```

このdとmを求める式をPythonで表現してやるだけです。  
`pow(a, b, c)`としてやると、`a^b mod c`の計算をしてくれます。  

```Python
d = pow(e, -1, (p-1)*(q-1))
m = pow(c, d, N)
```

できたPythonスクリプトを実行しましょう。  

```python=
from Crypto.Util.number import *

N = 139545190714430068475576764812975357667464073284160289806505868139812654946288354726950792923375840936420303267807422056935679442929570433104035467123877055792288916411159874481480708680994573100772667181210728673208401103290224577385585201704579349144430206926796515330551855562249705212503592520460211886543
p = 11383938152199742827534935881358756240953537245001429975067950092568380785232734527454719451207567674269717863796856119055836926302422957310664236155138179
q = 12258077024730273280785134915444958829950078762102753700909392695406980129736481201561609328208930770948117006493475096389813750697110857899618785618712517
e = 65537
c = 89675246336626125589202524856849238298873897483128546629098448254648587539910961108277785357974755856265417656437743402598137226531575794232735408657938035104005955311135456462714396628353894890013983440582041571931121456643482287667095371606889333823039961323430089926834087279121016547453409637455052852523

d = pow(e, -1, (p-1)*(q-1))
m = pow(c, d, N)
print(long_to_bytes(m))
```

```
flag{h3llo_R54}
```
